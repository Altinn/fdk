<alert type="success" *ngIf="saved">
  Sist lagret {{lastSaved}}
</alert>
<alert type="info" *ngIf="!saved">
  Endringer lagres automatisk
</alert>

<div class="panel fdk-panel" *ngIf="dataset" id="dataset">
  <div class="fdk-panel-big-heading">
    <input  class="fdk-register-h1" id="tittel-datasett" (keyup)="valuechange($event)" type="text" placeholder="Tittel" [(ngModel)]="dataset.title[language]"/>
  </div>
  <div class="fdk-panel-big-body">
    <h2 id="datasett-utgiver-navn">{{dataset.publisher.name}}</h2>
    <textarea autofocus class="fdk-register-h3" rows="5" id="beskrivelse-datasett" (ngModelChange)="valuechange(this)" placeholder="Beskrivelse" [(ngModel)]='dataset.description[language]'></textarea>
  </div>
</div>

<div class="panel fdk-panel" *ngIf="dataset">
  <div class="fdk-panel-heading">
    Opplysninger
  </div>
  <div class="fdk-panel-body">
    <div class="form-group">
      <div class="row form-group">
        <label for="emneord-datasett" class="col-md-1 control-label">Emneord:</label>
        <div class="col-md-11">
          <input id="emneord-datasett" type="text" class="form-control" [(ngModel)]='dataset.keywords[language]'/>
        </div>
      </div>
      <div class="row form-group">
        <label for="begrep-datasett" class="col-md-1 control-label">Begrep:</label>
        <div class="col-md-11">
          <input id="begrep-datasett" type="text" class="form-control"  [(ngModel)]='dataset.terms'  />
        </div>
      </div>

      <div class="row form-group">
        <label for="tema-datasett" class="col-md-1 control-label">Tema:</label>
        <form [formGroup]="themesForm" class="col-md-11">
          <ng-select
            (ngModelChange)="valuechange()"
        		[options]="themes"
        		[multiple]="true"
        		placeholder="Velg Tema"
            formControlName="themes">
        	</ng-select>
        </form>
      </div>
      <div (click)="fetchCodes('frequencies')" class="row form-group">
        <label for="tema-datasett" class="col-md-1 control-label">Datasettet oppdateres:</label>
        <form [formGroup]="accrualPeriodicityForm" class="col-md-11">
          <ng-select
            (ngModelChange)="valuechange()"
        		[options]="frequencies"
        		[multiple]="false"
        		placeholder="Velg..."
            formControlName="accrualPeriodicityControl">
        	</ng-select>
        </form>
      </div>
      <div (click)="fetchCodes('provenancestatements')" class="row form-group">
        <label for="tema-datasett" class="col-md-1 control-label">Ã…rsak til at datasettet finnes (provenance statement)</label>
        <form [formGroup]="provenanceForm" class="col-md-11">
          <ng-select
            (ngModelChange)="valuechange()"
        		[options]="provenancestatements"
        		[multiple]="false"
        		placeholder="Velg..."
            formControlName="provenanceControl">
        	</ng-select>
        </form>
      </div>

      <div class="row form-group">
        <label for="landingsside-datasett" class="col-md-1 control-label">Landingsside:</label>
        <div class="col-md-11">
          <input id="landingsside-datasett" (ngModelChange)="valuechange(this)" type="text" class="form-control"  [(ngModel)]='dataset.landingPage'  />
        </div>
      </div>

    </div>
  </div>


    <div class="panel fdk-panel" *ngIf="dataset && dataset.contactPoints">
        <div class="fdk-panel-heading">
            Kontaktinformasjon
        </div>
        <div class="fdk-panel-body">
            <div class="form-group">
                <div class="row form-group">
                    <label for="contact-avdeling" class="col-md-1 control-label">Avdeling:</label>
                    <div class="col-md-11">
                        <input id="contact-avdeling" type="text" (ngModelChange)="valuechange(this)"
                               class="form-control"
                               [(ngModel)]='dataset.contactPoints[0].organizationUnit'/>
                    </div>
                </div>
                <div class="row form-group">
                    <label for="contact-url" class="col-md-1 control-label">Kontaktskjema:</label>
                    <div class="col-md-11">
                        <input id="contact-url" type="text" (ngModelChange)="valuechange(this)" class="form-control"
                               [(ngModel)]='dataset.contactPoints[0].hasURL'/>
                    </div>
                </div>
                <div class="row form-group">
                    <label for="contact-email" class="col-md-1 control-label">E-post:</label>
                    <div class="col-md-11">
                        <input id="contact-email" type="email" ng-model="email.text" (ngModelChange)="valuechange(this)"
                               class="form-control" [(ngModel)]='dataset.contactPoints[0].email'/>
                    </div>
                </div>
                <div class="row form-group">
                    <label for="contact-telephone" class="col-md-1 control-label">Telefon:</label>
                    <div class="col-md-11">
                        <input id="contact-telephone" type="text" (ngModelChange)="valuechange(this)"
                               ng-pattern="[\+]?[0-9]+"
                               title="Oppgi telefonnummer" class="form-control"
                               [(ngModel)]='dataset.contactPoints[0].hasTelephone'/>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="panel fdk-panel" *ngIf="dataset.distributions">
        <div class="fdk-panel-heading">
            Distribusjoner ({{dataset.distributions.length}})
        </div>

        <div id="dist-accordion" class="fdk-panel-body">
            <div *ngFor="let distribution of dataset.distributions" class="panel fkd-panel-body row fdk-row-padding">
                <a >
                    <h4><i class="fa fa-caret-right" aria-hidden="true"></i> {{distribution.format}}</h4>
                </a>

                <div *ngIf="distribution" id="{{distribution.id}}" class="form-group">
                    <div class="row form-group">
                        <label for="dist-format" class="col-md-1 control-label">Format:</label>
                        <div class="col-md-11">
                            <input id="dist-format" type="text" (ngModelChange)="valuechange(this)"
                                   class="form-control"
                                   [(ngModel)]='distribution.format'/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <label for="dist-description" class="col-md-1 control-label">Kommentar:</label>
                        <div class="col-md-11">
                            <input id="dist-description" type="text" (ngModelChange)="valuechange(this)"
                                   class="form-control"
                                   [(ngModel)]='distribution.description[language]'/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <label for="dist-accessUrl" class="col-md-1 control-label">TilgangsURL:</label>
                        <div class="col-md-11">
                            <input id="dist-accessUrl" type="email" (ngModelChange)="valuechange(this)"
                                   class="form-control" [(ngModel)]='distribution.accessUrl'/>
                        </div>
                    </div>
                    <div class="row form-group">
                        <label for="dist-lisence" class="col-md-1 control-label">Lisens:</label>
                        <div class="col-md-11">
                            <input id="dist-lisence" type="email" (ngModelChange)="valuechange(this)"
                                   class="form-control" [(ngModel)]='distribution.license'/>
                        </div>
                    </div>

                    <div class="row form-group">
                        <label for="dist-downloadUrl" class="col-md-1 control-label">NedlastingsURL:</label>
                        <div class="col-md-11">
                            <input id="dist-downloadUrl" type="email" (ngModelChange)="valuechange(this)"
                                   class="form-control" [(ngModel)]='distribution.downloadUrl'/>
                        </div>
                    </div>
                </div>

            </div>
            <div class="fdk-panel-body">
                Legg til ny distribusjon
                <button class="btn pull-right" type="button" aria-label="Create new distribution"><i class="fa fa-plus-circle" aria-hidden="true"></i></button>
            </div>
        </div>
    </div>





</div>



  <button type="button" class="btn btn-default fdk-label fdk-label-default" (click)="back()">Tilbake</button>
  <button type="button" class="btn btn-default fdk-label fdk-label-default" (click)="showConfirmDelete()">Slett
    datasett
  </button>
