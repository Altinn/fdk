<div class="row">
  <div class="col-md-12" *ngIf="catalog">
    <div class="" *ngIf="catalog">
      <div class="">
        <div class="form-group">
          <h1>
            <input id="tittel-datakatalog" (ngModelChange)="valuechange()" type="text" class="fdk-register-h1" placeholder="Tittel" [(ngModel)]="catalog.title[language]"/>
          </h1>
        </div>
      </div>
      <div>
        <h4>Eies av {{catalog.publisher.name}}</h4>
      </div>
      <div class="fdk-container fdk-container-collapsed" style="margin-top:20px" (click)="descriptionExpanded = !descriptionExpanded; " [hidden]="descriptionExpanded">
        <span>{{catalog.description[language]}}</span>
      </div>
      <div class="fdk-container fdk-container-expanded" style="margin-top:20px" [hidden]="!descriptionExpanded">
        <label class="fdk-input-label">Beskrivelse <span class="fdk-obligatorisk">Obligatorisk</span></label>
        <p class="fdk-input-helptext">Hjelpetekst som beskriver hvordan feltene skal fylles ut på en god måte. Flere anbefalinger.</p>
        <textarea class="" (blur)="descriptionExpanded = !descriptionExpanded" (ngModelChange)="valuechange()" rows="5" id="beskrivelse-datakatalog" placeholder="Beskrivelse" [(ngModel)]='catalog.description[language]'></textarea>
      </div>

    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <hr/>
  </div>
</div>
<div class="row">

  <div class="col-md-12" *ngIf="catalog" style="margin-bottom:20px">
    <a (click)="newDataset()" href="#" id="button_new_dataset">
      <i class="fa fa-plus fdk-color-icon-cta" aria-hidden="true" style="padding-right:0.2em"></i>Legg til ny datasettbeskrivelse
    </a>
    <button type="button" class="fdk-button fdk-button-default" (click)="modalimport.show()">Importer dataset</button>

    <app-modal #modalimport>
      <div class="app-modal-header">
        Importer datasett fra DCAT RDF ressurs.
      </div>
      <div class="app-modal-body">
        <p>DCAT-modellen som blir importert må inneholde en katalog som har samme organisasjonsnr som katalogen du redigerer. Kun datasett som er med i denne katalogen vil bli importert.</p>
        Angi url til DCAT ressurs:
        <input id="dataset-import-url" class="fdk-input" type="url" [(ngModel)]='import.datasetImportUrl'>

        <div *ngIf="import.importErrorMessage" class="alert alert-danger">{{import.importErrorMessage}}</div>
      </div>
      <div class="app-modal-footer">
        <button type="button" class="btn btn-default" (click)="modalAbort(modalimport)">Avbryt</button>
        <button *ngIf="!import.importLoading" type="button" class="btn btn-primary" (click)="datasetImport(modalimport)">Importer!</button>
        <button *ngIf="import.importLoading" type="button" class="btn btn-primary" disabled><i class="fa fa-spinner fa-spin"></i> Importerer</button>
      </div>
    </app-modal>
  </div>
</div>

<div class="row">
  <div class="col-md-12" *ngIf="catalog">


    <table class="fdk-dataset" style="table-layout: fixed">
      <thead>
      <tr>
        <td>Tittel på datasett <i class="fa fa-sort-down" aria-hidden="true"></i></td>
        <td style="width: 150px">Status  <i class="fa fa-sort" aria-hidden="true"></i></td>
      </tr>
      </thead>

      <tbody>
      <tr *ngIf="datasets.length === 0">
        <td (click)="newDataset()" colspan="2" class="fdk-input-helptext">Ingen datasettbeskrivelse registrert. <a href="#">Klikk for å legge til.</a></td>
      </tr>
      <tr *ngFor="let dataset of datasets" id="datasets" class="fdk-row-padding">
        <td (click)="selectDataset(catalog, dataset)" class="fdk-register fdk-register-datacatalogue-1">
          <div *ngIf="getTitle(dataset);then showTitle else emptyTitle"></div>
          <ng-template #showTitle>{{getTitle(dataset)}}</ng-template>
          <ng-template #emptyTitle><span class="fdk-input-helptext">Mangler tittel</span></ng-template>
        </td>
        <td class="fdk-register fdk-register-datacatalogue-2">
                <span *ngIf="dataset.registrationStatus">
                <svg width="18" height="18" style="margin-right:8px; vertical-align: top">
                    <circle [attr.fill]="getColorForRegistrationStatus(dataset.registrationStatus)" r="9" cy="9" cx="9"/>
                </svg>
                <span>{{getTextForRegistrationStatus(dataset.registrationStatus)}}</span>
                    </span>
        </td>
      </tr>
      </tbody>
    </table>


  </div>
</div>
