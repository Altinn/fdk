<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <title th:text="#{app.title}">Felles datakatalog</title>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="dcatQueryService" th:content="${session.dcatQueryService}"/>
    <link rel="stylesheet" href="webjars/bootstrap/3.3.7/css/bootstrap.min.css" media="all"/>
    <link rel="stylesheet" href="css/main.css" media="all"/>
    <style>
        body {
            padding-top: 0px;
            padding-bottom: 0px;
        }
    </style>
</head>
<body>

<div lang="en" th:replace="header :: version" />

<div class="container">

    <div th:replace="header :: header"/>

    <span id="dosearch" class="glyphicon-search-frontpage glyphicon glyphicon-search"></span>

    <div class="row">
        <div class="col-md-12">
            <h1 class="fdk-heading" th:text="#{app.title}">Felles Datakatalog</h1>

            <input id="search" class="fdk-search" type="search" th:attr="placeholder=#{query.intro}"/>

            <section class="frontpage-themes">
                <a th:each="t : ${themes}" th:href="${'/results?theme=' + {t.code}}">
                    <span class="fdk-label fdk-label-default"
                          th:text="${(lang == 'en' ? t.title.get('en') : t.title.get('nb')) + ' (' + t.numberOfHits +')'}"/>
                </a>
            </section>

        </div>
    </div>
</div>


<div>
    <a href="/publisher" th:text="#{app.publisher}">Publisher</a>
</div>


<div lang="en" th:replace="footer :: footer" />

<script src="webjars/jquery/3.1.1/jquery.min.js"></script>
<script src="webjars/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
/*<![CDATA[*/

    var lang = navigator.language || navigator.userLanguage;
    console.log("browser language: ", lang);
    var params= window.location.search.substr(1);
    var pair = params.split("=");
    if (pair[0] === "lang") {
       lang = pair[1];
    }

    console.log("application lang: " , lang);
    // set correct chosen language
    var langElement = document.getElementById("lang." + lang);
    $("#chosenLanguage").html($(langElement).html() + ' <span class="caret"></span>');

    // handle language toggle
    /*$(".dropdown-menu li a").click(function(event){
        $(this).parents(".dropdown").find('.btn').html($(this).html() + ' <span class="caret"></span>');
    });*/

    // Set up searchbar controller
    function searchController() {
        var search = document.getElementById("search");
        var dosearch = document.getElementById("dosearch");

        if (dosearch)
            dosearch.onclick = function (event) {
                var query = "?q=" + search.value ;
                console.log("traverse ", query);
                window.location = "/results" + query;

            };

        if (search)
            search.onkeypress = function (event) {
                if (event.keyCode === 13) {
                    var query = "?q=" + search.value  ;
                    console.log("traverse ", query);
                    window.location = "/results" + query;

                }
            };
    }
    $(document).ready(searchController());
/*]]>*/
</script>
</body>
</html>